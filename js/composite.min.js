/* composite.js v0.2 (c) 2013 Atsushi Mizoue. */!function(){var f=!0,g=!1,k=g,l=/0/.test(function(){0})?/\b_super\b/:/.*/;function m(){}function n(b,a){return Object.prototype.toString.call(a)=="[object "+b+"]"?f:g}function q(b){var a;a=[];a.push.apply(a,b);return a}
m.extend=function(b,a,d){function c(){!k&&this.init&&this.init.apply(this,arguments)}function e(d){var e=b[d],p=a.prototype[d];n("Function",e)&&n("Function",p)&&l.test(e)?c.prototype[d]=function(){var a,b=this._super;this._super=p;a=e.apply(this,arguments);this._super=b;return a}:c.prototype[d]=e}a=this;k=f;c.prototype=new a;k=g;c.prototype.constructor=c;for(d in b)b.hasOwnProperty(d)&&e(d);c.extend=a.extend;return c};
function r(){var b=q(arguments||[]),a=this.only.apply(this,b);if(g!==a&&!(a||{}).e)(a=this.a)&&a.bubble.apply(a,b)}function s(){this.d=f}function t(){this.e=f}
Composite=m.extend({dispose:function(b,a,d){b=this;b.removeChild();for(a in b)(d=b[a])&&d.dispose&&d.dispose();b.__proto__=null;for(a in b)b[a]=null,delete b[a]},init:function(){this.c={};this.b=[]},on:function(b,a,d,c){c=this.c;c[b]||(c[b]=[]);c[b].push(a)},one:function(b,a,d,c){d=this;c=function(){a.apply(d,arguments);d.off(b,c)};c.f=a;d.on(b,c)},off:function(b,a,d,c,e,h){c=this.c;if(a){if(e=c[b])for(h=e.length;h--;)if(a==e[h]||a==e[h].f)return e.splice(h,1),0==e.length&&delete c[b],f;return g}return delete c[b]},
fire:r,bubble:r,capture:function(){var b=arguments,a=this.b,d=a.length,c;if(g!==this.only.apply(this,b))for(;d--;)c=a[d],c.capture.apply(c,b)},only:function(){var b=q(arguments),a;a=b[0];n("String",a)&&(a={type:a,arguments:b,d:g,e:g,preventDefault:s,stopPropagation:t});a.before=a.target;a.target=this;var d=this.c[a.type]||[],c,e=d.length;b.splice(0,1);for(b[b.length]=a;e--;)if(c=d[e])if(c=c.apply(this,b),c===g||a.d)return c;return a},addChild:function(b){b.a&&b.a.removeChild(b);b.a=this;this.b.push(b)},
removeChild:function(b){var a=this.b,d=a.length;if(b)for(;d--;){if(a[d]===b){delete a[d].a;a.splice(d,1);break}}else for(;d--;){b=a;var c=d;delete b[c].a;b.splice(c,1)}}});}();
