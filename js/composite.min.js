/* composite.js v0.2 (c) 2013 Atsushi Mizoue. */!function(){var f=!1,g,h,k,l,m,n,p,q,s,t,u,v,w,x={}.hasOwnProperty;q=f;p=/0/.test(function(){0})?/\b_super\b/:/.*/;g=function(){};w=function(a,b){return Object.prototype.toString.call(b==="[object "+a+"]")?!0:f};u=function(a){return w("String",a)};t=function(a){return w("Function",a)};s=function(a,b){a.splice(b,1)};v=function(a){var b;b=[];b.push.apply(b,a);return b};
g.extend=function(a){var b,c,d;b=this;g=function(){!q&&this.init&&this.init.apply(this,arguments)};c=function(c){var d,r;d=a[c];r=b.prototype[c];t(d)&&t(r)&&p.test(d)?g.prototype[c]=function(){var a,b;b=this._super;this._super=r;a=d.apply(this,arguments);this._super=b;return a}:g.prototype[c]=d};q=!0;g.prototype=new b;q=f;g.prototype.constructor=g;for(d in a)x.call(a,d)&&c(d);g.extend=b.extend;return g};m=function(a,b){delete a[b].a;s(a,b)};
h=function(){var a,b;a=v(arguments||[]);b=this.only.apply(this,a);if(f!==b&&!(b||{}).e)(b=this.a)&&b.bubble.apply(b,a)};l=function(){return this.d=!0};n=function(){return this.e=!0};k=function(a,b){var c;c=b[0];u(c)&&(c={type:c,arguments:b,d:f,e:f,preventDefault:l,stopPropagation:n});c.before=c.target;c.target=a;return c};
window.Composite=g.extend({init:function(){this.c={};return this.b=[]},dispose:function(){var a,b;this.removeChild;for(a in this)(b=this[a])&&b.dispose&&b.dispose;this.__proto__=null;for(a in this)this[a]=null,delete this[a]},on:function(a,b){var c;c=this.c;c[a]||(c[a]=[]);c[a].push(b)},one:function(a,b){var c,d;c=this;d=function(){b.apply(c,arguments);c.off(a,d)};d.f=b;c.on(a,d)},off:function(a,b){var c,d,e;d=this.c;if(b){if(e=d[a])for(c=e.length;c--;)if(b===e[c]||b===e[c].f)return s(e,c),0===e.length&&
delete d[a],!0;return f}return delete d[a]},fire:h,bubble:h,capture:function(){var a,b,c,d;a=arguments;b=this.b;c=b.length;if(f!==this.only.apply(this,a))for(;c--;)d=b[c],d.capture.apply(d,a)},only:function(){var a,b,c,d,e;a=v(arguments);b=k(this,a);d=this.c[b.type]||[];c=d.length;s(a,0);for(a[a.length]=b;c--;)if(e=d[c])if(e=e.apply(this,a),e===f||b.d)return e;return b},addChild:function(a){a.a&&a.a.removeChild(a);a.a=this;this.b.push(a)},removeChild:function(a){var b,c;b=this.b;c=b.length;if(a)for(;c--;){if(b[c]===
a){m(b,c);break}}else for(;c--;)m(b,c)}});}();
