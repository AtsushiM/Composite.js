/* composite.js v1.0 (c) 2013 Atsushi Mizoue. */!function(){var f=!1,g,k,l,m,n,p,q,r,s,u,v,w,x,y,z,A={}.hasOwnProperty;x="undefined"===typeof module?window:module.exports;s=f;r=/0/.test(function(){0})?/\b_super\b/:/.*/;g=function(){};z=function(a,c){return Object.prototype.toString.call(c)==="[object "+a+"]"?!0:f};w=function(a){return z("String",a)};v=function(a){return z("Function",a)};u=function(a,c){a.splice(c,1)};y=function(a){var c;c=[];c.push.apply(c,a);return c};
g.extend=function(a){var c,b,d;c=this;g=function(){!s&&this.init&&this.init.apply(this,arguments)};b=function(b){var d,h;d=a[b];h=c.prototype[b];v(d)&&v(h)&&r.test(d)?g.prototype[b]=function(){var a,b;b=this._super;this._super=h;a=d.apply(this,arguments);this._super=b;return a}:g.prototype[b]=d};s=!0;g.prototype=new c;s=f;g.prototype.constructor=g;for(d in a)A.call(a,d)&&b(d);g.extend=c.extend;return g};p=function(a,c){delete a[c].a;u(a,c)};
k=function(){var a,c,b;a=y(arguments||[]);c=a[2];a=a.slice(0,2);b=this.only.apply(this,a);if(f!==b&&!(b||{}).e)(b=this.a)&&b.bubble.apply(b,a);m(c)};m=function(a){v(a)&&a.apply(this)};n=function(){this.d=!0};q=function(){this.e=!0};l=function(a,c){var b;b=c[0];w(b)&&(b={type:b,arguments:c,d:f,e:f,preventDefault:n,stopPropagation:q});b.before=b.target;b.target=a;return b};
x.Composite=g.extend({init:function(){this.c={};return this.b=[]},dispose:function(){var a,c;this.removeChild;for(a in this)(c=this[a])&&c.dispose&&c.dispose;this.__proto__=null;for(a in this)this[a]=null,delete this[a]},on:function(a,c){var b;b=this.c;b[a]||(b[a]=[]);b[a].push(c)},one:function(a,c){var b,d;b=this;d=function(){c.apply(b,arguments);b.off(a,d)};d.f=c;b.on(a,d)},off:function(a,c){var b,d,e,t,h;d=this.c;if(c){if(e=d[a])for(b=h=e.length-1;0<=h;b=h+=-1)if(t=e[b],c===t||c===t.f)return u(e,
b),0===e.length&&delete d[a],!0;return f}return delete d[a]},emit:k,bubble:k,capture:function(){var a,c,b,d,e;a=y(arguments);c=a[2];b=this.b;a=a.slice(0,2);if(f!==this.only.apply(this,a))for(e=b.length-1;0<=e;e+=-1)d=b[e],d.capture.apply(d,a);m(c)},only:function(){var a,c,b,d,e;a=y(arguments);c=l(this,a);b=this.c[c.type]||[];a[0]=c;for(e=b.length-1;0<=e;e+=-1)if(d=b[e])if(d=d.apply(this,a),d===f||c.d)return d;m(a[2]);return c},addChild:function(a){a.a&&a.a.removeChild(a);a.a=this;this.b.push(a)},
removeChild:function(a){var c,b,d;c=this.b;if(a)for(b=d=c.length-1;0<=d;b=d+=-1){if(c[b]===a){p(c,b);break}}else for(b=a=c.length-1;0<=a;b=a+=-1)p(c,b)}});}();
