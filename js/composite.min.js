/* composite.js v0.1 (c) 2013 Atsushi Mizoue. */!function(){var f=!0,g=!1,k=g,l=/0/.test(function(){0})?/\b_super\b/:/.*/;function m(){}function p(a,b){return Object.prototype.toString.call(b)=="[object "+a+"]"?f:g}
m.extend=function(a,b,d){function c(){!k&&this.init&&this.init.apply(this,arguments)}function e(d){var e=a[d],n=b.prototype[d];p("Function",e)&&p("Function",n)&&l.test(e)?c.prototype[d]=function(){var a,b=this._super;this._super=n;a=e.apply(this,arguments);this._super=b;return a}:c.prototype[d]=e}b=this;k=f;c.prototype=new b;k=g;c.prototype.constructor=c;for(d in a)a.hasOwnProperty(d)&&e(d);c.extend=b.extend;return c};
function q(){var a=arguments,b=this.only.apply(this,a);if(g!==b&&!(b||{}).e)(b=this.a)&&b.bubble.apply(b,a)}function r(){this.d=f}function s(){this.e=f}
Composite=m.extend({dispose:function(a,b,d){a=this;a.removeChild();for(b in a)(d=a[b])&&d.dispose&&d.dispose();a.__proto__=null;for(b in a)a[b]=null,delete a[b]},init:function(){this.c={};this.b=[]},on:function(a,b,d,c){c=this.c;c[a]||(c[a]=[]);c[a].push(b)},one:function(a,b,d,c){d=this;c=function(e){b.apply(d,e);d.off(a,c)};c.f=b;d.on(a,c)},off:function(a,b,d,c,e,h){c=this.c;if(b){if(e=c[a])for(h=e.length;h--;)if(b==e[h]||b==e[h].f)return e.splice(h,1),0==e.length&&delete c[a],f;return g}return delete c[a]},
fire:q,bubble:q,capture:function(){var a=arguments,b=this.b,d=b.length,c;if(g!==this.only.apply(this,a))for(;d--;)c=b[d],c.capture.apply(c,a)},only:function(){var a;a=[];a.push.apply(a,arguments);var b;b=a[0];p("String",b)&&(b={type:b,arguments:a,d:g,e:g,preventDefault:r,stopPropagation:s});b.before=b.target;b.target=this;var d=this.c[b.type]||[],c,e=d.length;a.splice(0,1);for(a[a.length]=b;e--;)if(c=d[e])if(c=c.apply(this,a),c===g||b.d)return c;return b},addChild:function(a){a.a&&a.a.removeChild(a);
a.a=this;this.b.push(a)},removeChild:function(a){var b=this.b,d=b.length;if(a)for(;d--;){if(b[d]===a){delete b[d].a;b.splice(d,1);break}}else for(;d--;){a=b;var c=d;delete a[c].a;a.splice(c,1)}}});}();
