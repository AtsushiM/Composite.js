/* composite.js v0.2 (c) 2013 Atsushi Mizoue. */!function(){var e=!1,g,k,l,m,n,p,q,r,t,u,v,w,x,y={}.hasOwnProperty;r=e;q=/0/.test(function(){0})?/\b_super\b/:/.*/;g=function(){};x=function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"?!0:e};v=function(a){return x("String",a)};u=function(a){return x("Function",a)};t=function(a,b){a.splice(b,1)};w=function(a){var b;b=[];b.push.apply(b,a);return b};
g.extend=function(a){var b,c,d;b=this;g=function(){!r&&this.init&&this.init.apply(this,arguments)};c=function(c){var d,h;d=a[c];h=b.prototype[c];u(d)&&u(h)&&q.test(d)?g.prototype[c]=function(){var a,b;b=this._super;this._super=h;a=d.apply(this,arguments);this._super=b;return a}:g.prototype[c]=d};r=!0;g.prototype=new b;r=e;g.prototype.constructor=g;for(d in a)y.call(a,d)&&c(d);g.extend=b.extend;return g};n=function(a,b){delete a[b].a;t(a,b)};
k=function(){var a,b;a=w(arguments||[]);b=this.only.apply(this,a);if(e!==b&&!(b||{}).e)(b=this.a)&&b.bubble.apply(b,a)};m=function(){return this.d=!0};p=function(){return this.e=!0};l=function(a,b){var c;c=b[0];v(c)&&(c={type:c,arguments:b,d:e,e:e,preventDefault:m,stopPropagation:p});c.before=c.target;c.target=a;return c};
window.Composite=g.extend({init:function(){this.c={};return this.b=[]},dispose:function(){var a,b;this.removeChild;for(a in this)(b=this[a])&&b.dispose&&b.dispose;this.__proto__=null;for(a in this)this[a]=null,delete this[a]},on:function(a,b){var c;c=this.c;c[a]||(c[a]=[]);c[a].push(b)},one:function(a,b){var c,d;c=this;d=function(){b.apply(c,arguments);c.off(a,d)};d.f=b;c.on(a,d)},off:function(a,b){var c,d,f,s,h;d=this.c;if(b){if(f=d[a])for(c=h=f.length-1;0<=h;c=h+=-1)if(s=f[c],b===s||b===s.f)return t(f,
c),0===f.length&&delete d[a],!0;return e}return delete d[a]},fire:k,bubble:k,capture:function(){var a,b,c,d;a=arguments;b=this.b;if(e!==this.only.apply(this,a))for(d=b.length-1;0<=d;d+=-1)c=b[d],c.capture.apply(c,a)},only:function(){var a,b,c,d,f;a=w(arguments);b=l(this,a);c=this.c[b.type]||[];t(a,0);a[a.length]=b;for(f=c.length-1;0<=f;f+=-1)if(d=c[f])if(d=d.apply(this,a),d===e||b.d)return d;return b},addChild:function(a){a.a&&a.a.removeChild(a);a.a=this;this.b.push(a)},removeChild:function(a){var b,
c,d;b=this.b;if(a)for(c=d=b.length-1;0<=d;c=d+=-1){if(b[c]===a){n(b,c);break}}else for(c=a=b.length-1;0<=a;c=a+=-1)n(b,c)}});}();
